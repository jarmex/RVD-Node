{"version":3,"sources":["../../src/UssdCollectStep.js"],"names":["UssdCollectSteps","step","data","temp","retmsg","messages","text","gatherType","menu","collectdigits","message","msgs","mMenu","map","item","join","responses","mappings"],"mappings":";;;;;AAAA;;AACA;;;;;;IAEqBA,gB;mCACT,OAAOC,IAAP,EAAaC,IAAI,GAAG,EAApB,EAAwBC,IAAI,GAAG,EAA/B,KAAsC;AAC9C,UAAMC,MAAM,GAAG,EAAf,CAD8C,CAE9C;;AACA,UAAM;AAAEC,MAAAA,QAAF;AAAYC,MAAAA,IAAZ;AAAkBC,MAAAA,UAAlB;AAA8BC,MAAAA,IAA9B;AAAoCC,MAAAA;AAApC,QAAsDR,IAA5D,CAH8C,CAK9C;;AACAG,IAAAA,MAAM,CAACM,OAAP,GAAiB,+BAAiBJ,IAAjB,EAAuBJ,IAAvB,EAA6BC,IAA7B,CAAjB,CAN8C,CAO9C;;AACA,UAAMQ,IAAI,GAAG,0BAAYN,QAAZ,CAAb;;AAEA,QAAIA,QAAJ,EAAc;AACZ,YAAMO,KAAK,GAAGD,IAAI,CACfE,GADW,CACNC,IAAD,IAAU,+BAAiBA,IAAI,CAACR,IAAtB,EAA4BJ,IAA5B,EAAkCC,IAAlC,CADH,EAEXY,IAFW,CAEN,IAFM,CAAd;AAGAX,MAAAA,MAAM,CAACM,OAAP,GAAkB,GAAEJ,IAAK,GAAEM,KAAM,EAAjC;AACD;;AAED,UAAMI,SAAS,GAAG;AAChBT,MAAAA;AADgB,KAAlB,CAjB8C,CAoB9C;;AACA,QAAIC,IAAJ,EAAU;AACRQ,MAAAA,SAAS,CAACC,QAAV,GAAqBT,IAAI,CAACS,QAA1B;AACD;;AACD,QAAIR,aAAJ,EAAmB;AACjBO,MAAAA,SAAS,CAACP,aAAV,GAA0BA,aAA1B;AACD;;AACDL,IAAAA,MAAM,CAACY,SAAP,GAAmBA,SAAnB;AACA,WAAOZ,MAAP;AACD,G","sourcesContent":["import ensureArray from './ensureArray';\nimport ReplaceVariables from './ReplaceVariables';\n\nexport default class UssdCollectSteps {\n  process = async (step, data = {}, temp = {}) => {\n    const retmsg = {};\n    // get the message to display\n    const { messages, text, gatherType, menu, collectdigits } = step;\n\n    // replace the variables in the text\n    retmsg.message = ReplaceVariables(text, data, temp);\n    // ensure the message is an array\n    const msgs = ensureArray(messages);\n\n    if (messages) {\n      const mMenu = msgs\n        .map((item) => ReplaceVariables(item.text, data, temp))\n        .join('\\n');\n      retmsg.message = `${text}${mMenu}`;\n    }\n\n    const responses = {\n      gatherType,\n    };\n    // map the responses\n    if (menu) {\n      responses.mappings = menu.mappings;\n    }\n    if (collectdigits) {\n      responses.collectdigits = collectdigits;\n    }\n    retmsg.responses = responses;\n    return retmsg;\n  };\n}\n"],"file":"UssdCollectStep.js"}